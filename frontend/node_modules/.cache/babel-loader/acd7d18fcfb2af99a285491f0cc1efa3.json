{"remainingRequest":"/home/bdafflon/Documents/PE/GMP-PE/frontend/node_modules/babel-loader/lib/index.js!/home/bdafflon/Documents/PE/GMP-PE/frontend/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/bdafflon/Documents/PE/GMP-PE/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/bdafflon/Documents/PE/GMP-PE/frontend/src/components/ChatComponent.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/bdafflon/Documents/PE/GMP-PE/frontend/src/components/ChatComponent.vue","mtime":1604652119599},{"path":"/home/bdafflon/Documents/PE/GMP-PE/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1604581624534},{"path":"/home/bdafflon/Documents/PE/GMP-PE/frontend/node_modules/babel-loader/lib/index.js","mtime":1604581624086},{"path":"/home/bdafflon/Documents/PE/GMP-PE/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1604581624534},{"path":"/home/bdafflon/Documents/PE/GMP-PE/frontend/node_modules/vue-loader/lib/index.js","mtime":1604581626534}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiL2hvbWUvYmRhZmZsb24vRG9jdW1lbnRzL1BFL0dNUC1QRS9mcm9udGVuZC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vb2JqZWN0U3ByZWFkMiI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCmltcG9ydCB7IG1hcFN0YXRlIH0gZnJvbSAndnVleCc7CmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiQ2hhdCIsCiAgcHJvcHM6IFsnY2FuZGlkYXR1cmUnXSwKICB3YXRjaDogewogICAgLy8gVGhpcyB3b3VsZCBiZSBjYWxsZWQgYW55dGltZSB0aGUgdmFsdWUgb2YgdGl0bGUgY2hhbmdlcwogICAgY2FuZGlkYXR1cmU6IGZ1bmN0aW9uIGNhbmRpZGF0dXJlKG5ld1ZhbHVlLCBvbGRWYWx1ZSkgewogICAgICBjb25zb2xlLmRlYnVnKG9sZFZhbHVlKTsKICAgICAgdGhpcy5jYW5kaWRhdHVyZSA9IG5ld1ZhbHVlOwogICAgICB0aGlzLmNsZWFyQWxsTWVzc2FnZXMoKTsKICAgICAgdGhpcy5mZXRjaERhdGEoKTsKICAgIH0KICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBib2JNZXNzYWdlOiAnJywKICAgICAgeW91TWVzc2FnZTogJycsCiAgICAgIG1lc3NhZ2VzOiBbewogICAgICAgIGlkOiAxLAogICAgICAgIGJvZHk6ICdXZWxjb21lIHRvIHRoZSBjaGF0LCBJXCdtIEJvYiEnLAogICAgICAgIGF1dGhvcjogJ2JvYicKICAgICAgfSwgewogICAgICAgIGlkOiAyLAogICAgICAgIGJvZHk6ICdUaGFuayB5b3UgQm9iJywKICAgICAgICBhdXRob3I6IDEKICAgICAgfSwgewogICAgICAgIGlkOiAzLAogICAgICAgIGJvZHk6ICdZb3VcJ3JlIG1vc3Qgd2VsY29tZScsCiAgICAgICAgYXV0aG9yOiAnYm9iJwogICAgICB9XQogICAgfTsKICB9LAogIGNvbXB1dGVkOiBfb2JqZWN0U3ByZWFkKHt9LCBtYXBTdGF0ZShbJ2FwaXVybCcsICdsb2dnaW5nSW4nLCAnbG9naW5FcnJvcicsICdhY2Nlc3NUb2tlbicsICdsb2dnZWQnLCAndXNlciddKSksCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIHRoaXMuZmV0Y2hEYXRhKCk7CiAgfSwKICBtZXRob2RzOiB7CiAgICBzY3JvbGxUb0VuZDogZnVuY3Rpb24gc2Nyb2xsVG9FbmQoKSB7CiAgICAgIHZhciBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIjY2hhdHJvb20iKTsKICAgICAgY29udGFpbmVyLnNjcm9sbFRvcCA9IGNvbnRhaW5lci5zY3JvbGxIZWlnaHQ7CiAgICB9LAogICAgc2VuZE1lc3NhZ2U6IGZ1bmN0aW9uIHNlbmRNZXNzYWdlKGRpcmVjdGlvbikgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgY29uc29sZS5kZWJ1Zyh0aGlzLm1lc3NhZ2VzKTsKCiAgICAgIGlmICghdGhpcy55b3VNZXNzYWdlICYmICF0aGlzLmJvYk1lc3NhZ2UpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmIChkaXJlY3Rpb24gPT09ICdvdXQnKSB7CiAgICAgICAgdGhpcy5hZGREYXRhKHRoaXMueW91TWVzc2FnZSk7CiAgICAgICAgdGhpcy55b3VNZXNzYWdlID0gJyc7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYWxlcnQoJ3NvbWV0aGluZyB3ZW50IHdyb25nJyk7CiAgICAgIH0KCiAgICAgIHRoaXMuJG5leHRUaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gX3RoaXMuc2Nyb2xsVG9FbmQoKTsKICAgICAgfSk7CiAgICB9LAogICAgY2xlYXJBbGxNZXNzYWdlczogZnVuY3Rpb24gY2xlYXJBbGxNZXNzYWdlcygpIHsKICAgICAgdGhpcy5tZXNzYWdlcyA9IFtdOwogICAgfSwKICAgIGFkZERhdGE6IGZ1bmN0aW9uIGFkZERhdGEobWVzc2FnZSkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIGNvbnNvbGUuZGVidWcobWVzc2FnZSk7CiAgICAgIGF4aW9zKHsKICAgICAgICBtZXRob2Q6ICdwb3N0JywKICAgICAgICB1cmw6ICdhY3Rpb25wZS9yZWdpc3RyYXRpb24nLAogICAgICAgIGRhdGE6IHsKICAgICAgICAgIGFjdGlvbjogbWVzc2FnZSwKICAgICAgICAgIGlkX2V0dWRpYW50OiB0aGlzLnVzZXIuaWQsCiAgICAgICAgICBpZF9jYW5kaWRhdHVyZTogdGhpcy5jYW5kaWRhdHVyZS5pZF9jYW5kaWRhdHVyZQogICAgICAgIH0sCiAgICAgICAgYXV0aDogewogICAgICAgICAgdXNlcm5hbWU6IHRoaXMudXNlci5tYWlsLAogICAgICAgICAgcGFzc3dvcmQ6IHRoaXMudXNlci5wd2QKICAgICAgICB9CiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgX3RoaXMyLm1lc3NhZ2VzLnB1c2goewogICAgICAgICAgaWRfYWN0aW9uOiByZXNwb25zZS5pZF9hY3Rpb24sCiAgICAgICAgICBhY3Rpb246IG1lc3NhZ2UsCiAgICAgICAgICBpZF9ldHVkaWFudDogX3RoaXMyLnVzZXIuaWQsCiAgICAgICAgICBpZF9jYW5kaWRhdHVyZTogX3RoaXMyLmNhbmRpZGF0dXJlLmlkX2NhbmRpZGF0dXJlCiAgICAgICAgfSk7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZGVidWcoZXJyb3IpOwogICAgICB9KTsKICAgIH0sCiAgICBmZXRjaERhdGE6IGZ1bmN0aW9uIGZldGNoRGF0YSgpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICBheGlvcyh7CiAgICAgICAgbWV0aG9kOiAnZ2V0JywKICAgICAgICB1cmw6ICdhY3Rpb25wZS8nICsgdGhpcy5jYW5kaWRhdHVyZS5pZF9jYW5kaWRhdHVyZSwKICAgICAgICBhdXRoOiB7CiAgICAgICAgICB1c2VybmFtZTogdGhpcy51c2VyLm1haWwsCiAgICAgICAgICBwYXNzd29yZDogdGhpcy51c2VyLnB3ZAogICAgICAgIH0KICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBfdGhpczMubWVzc2FnZXMgPSByZXNwb25zZS5kYXRhOwogICAgICAgIF90aGlzMy5jYW5kaWRhdHVyZS5hcCA9IDA7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZGVidWcoZXJyb3IpOwogICAgICB9KTsKICAgIH0KICB9Cn07"},{"version":3,"sources":["ChatComponent.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n<div>\n      <section ref=\"chatArea\" class=\"chat-area\" id=\"chatroom\" >\n    <p v-for=\"message in messages\" :key=\"message.id_action\" class=\"message\" :class=\"{ 'message-out': message.id_etudiant === user.id, 'message-in': message.id_etudiant !== user.id }\">\n      {{ message.action }}\n    </p>\n  </section>\n   <section class=\"\">\n\n    \n\n    <form @submit.prevent=\"sendMessage('out')\" id=\"person2-form\">\n        <div class=\"row\">\n          <div class=\"col-sm-8\">\n             <input v-model=\"youMessage\" type=\"text\" id=\"person2-input\" class=\"form-control\" placeholder=\"Message\" required autofocus>\n          </div>\n          <div class=\"col-sm-4\">\n            <button class=\"btn  btn-primary btn-block\" type=\"submit\">Envoyer</button>\n          </div>\n        </div>\n      \n        \n      \n    </form>\n  </section>\n</div>\n</template>\n\n<script>\nimport { mapState } from 'vuex';\nimport axios from 'axios';\n\nexport default {\n    name:\"Chat\",\n    props: ['candidature'],\n    watch: {\n    // This would be called anytime the value of title changes\n      candidature(newValue, oldValue) {\n        console.debug(oldValue)\n        this.candidature = newValue\n        this.clearAllMessages()\n        this.fetchData()\n    }\n  },\n    data() {\n      return {\n        bobMessage: '',\n        youMessage: '',\n        messages: [\n          { \n            id:1,\n            body: 'Welcome to the chat, I\\'m Bob!',\n            author: 'bob'\n          },\n          {\n            id:2,\n            body: 'Thank you Bob',\n            author: 1\n          },\n          {\n            id:3,\n            body: 'You\\'re most welcome',\n            author: 'bob'\n          }\n        ]\n      }\n    },\n    computed: {\n      ...mapState([\n'apiurl',\n        'loggingIn',\n        'loginError',\n        'accessToken',\n        'logged',\n        'user'\n      ])\n    },\n    created () {\n      this.fetchData()\n    },\n  methods: {\n    scrollToEnd: function() {    \t\n      \n      var container = document.querySelector(\"#chatroom\");\n      container.scrollTop = container.scrollHeight;\n    },\n    sendMessage(direction) {\n      console.debug(this.messages)\n      if (!this.youMessage && !this.bobMessage) {\n        return\n      }\n      if (direction === 'out') {\n        \n\n        this.addData(this.youMessage)\n        this.youMessage = ''\n      \n      } else {\n        alert('something went wrong')\n      }\n      \n      this.$nextTick(() => this.scrollToEnd());\n    },\n    clearAllMessages() {\n      this.messages = []\n    }\n  ,\n  addData(message){\n    console.debug(message)\n    axios({\n            method: 'post',\n            url: 'actionpe/registration',\n            data: {\n              action:message,\n              id_etudiant:this.user.id,\n              id_candidature:this.candidature.id_candidature\n            },\n            auth: {\n              username: this.user.mail,\n              password: this.user.pwd\n            }\n        })\n      .then(response => {\n          \n         this.messages.push({id_action:response.id_action, action:message,\n              id_etudiant:this.user.id,\n              id_candidature:this.candidature.id_candidature})\n         \n         \n          \n      })\n      .catch(error => {\n        console.debug(error)\n      })\n  },\n  fetchData () {\n          \n      \n      axios({\n            method: 'get',\n            url: 'actionpe/'+this.candidature.id_candidature,\n            auth: {\n              username: this.user.mail,\n              password: this.user.pwd\n            }\n        })\n      .then(response => {\n          \n         this.messages=response.data\n         this.candidature.ap=0\n         \n         \n          \n      })\n      .catch(error => {\n        console.debug(error)\n      })\n\n    }\n  }\n\n}\n</script>\n\n<style lang=\"scss\">\n   \n  @import \"../assets/custom.scss\";\n  @import \"node_modules/bootstrap/scss/bootstrap.scss\";\n  @import \"../assets/sb-admin-2.min.css\";\n\n\n.chat-area {\n/*   border: 1px solid #ccc; */\n  background: white;\n  max-height: 30vh;\n  padding: 1em;\n  overflow: auto;\n   \n  margin: 0 auto 2em auto;\n  }\n.message {\n  width: 50%;\n  border-radius: 10px;\n  padding: .5em;\n/*   margin-bottom: .5em; */\n  font-size: .8em;\n}\n.message-out {\n  background: #407FFF;\n  color: white;\n  margin-left: 50%;\n  text-align: right;\n}\n.message-in {\n  background: #F1F0F0;\n  color: black;\n  text-align: left;\n}\n.chat-inputs {\n  display: flex;\n  justify-content: space-between;\n}\n</style>"],"sourceRoot":"src/components"}]}